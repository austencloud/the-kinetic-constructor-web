<script lang="ts">
	import { fade } from 'svelte/transition';
	
	export let animationDuration = 300;
	export let showText = true;
	export let initializing = false;
	export let loadProgress = 0;
</script>

{#if initializing}
	<g transition:fade={{ duration: animationDuration }}>
		<rect x="425" y="425" width="100" height="100" fill="transparent" />
		<circle cx="475" cy="475" r="40" fill="none" stroke="#ccc" stroke-width="8" />
		<path
			d="M475 435 A40 40 0 0 1 515 475"
			fill="none"
			stroke="#4299e1"
			stroke-width="8"
			stroke-linecap="round"
		>
			<animate
				attributeName="stroke-dasharray"
				from="0 1000"
				to="1000 1000"
				dur="1s"
				repeatCount="indefinite"
			/>
		</path>
		<text
			x="50%"
			y="550"
			dominant-baseline="middle"
			text-anchor="middle"
			font-size="16"
			fill="#666"
		>
			Initializing...
		</text>
	</g>
{:else}
	<div class="loading-bar-container">
		<div class="loading-bar" style="width: {loadProgress}%"></div>
		{#if showText}
			<span class="loading-text">{loadProgress}%</span>
		{/if}
	</div>
{/if}

<style>
	/* Loading bar styles */
	.loading-bar-container {
		position: absolute;
		bottom: 10px;
		left: 10px;
		right: 10px;
		height: 4px;
		background-color: #edf2f7;
		border-radius: 2px;
		overflow: hidden;
		z-index: 5;
	}

	.loading-bar {
		height: 100%;
		background-color: #4299e1;
		transition: width 0.3s ease-out;
	}

	.loading-text {
		position: absolute;
		right: 0;
		top: -18px;
		font-size: 12px;
		color: #718096;
	}
</style>